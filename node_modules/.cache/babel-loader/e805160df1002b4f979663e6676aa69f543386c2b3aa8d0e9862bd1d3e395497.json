{"ast":null,"code":"// submitOrder.js\nimport sendViaWhatsApp from './sendViaWhatsApp';\nimport exportToCSV from './exportToCSV'; // For stock journal Excel\n\nexport default function submitOrder({\n  cart,\n  dealer,\n  vehicleName,\n  vehicleNumber,\n  notes,\n  totalCTN,\n  showToast\n}) {\n  try {\n    const dealerName = (dealer === null || dealer === void 0 ? void 0 : dealer[\"Dealer Name\"]) || \"Unknown Dealer\";\n    const phoneNumber = (dealer === null || dealer === void 0 ? void 0 : dealer[\"Phone Number\"]) || \"919929988408\";\n    const timestamp = new Date().toLocaleString().replace(/[/,: ]+/g, \"_\");\n    const safeDealer = dealerName.replace(/\\s+/g, \"_\");\n    const filename = `${safeDealer}_${timestamp}`;\n\n    // ‚úÖ 1. Export Excel\n    exportToCSV(cart, filename, vehicleName, vehicleNumber, notes);\n    if (typeof showToast === 'function') {\n      showToast(\"üßæ Stock Journal Excel downloaded\");\n    }\n\n    // ‚úÖ 2. Build WhatsApp message\n    let msg = `üõí *Factory to Office Dispatch Summary*\\nüë§ ‡§∏‡§∞‡§®‡§æ ‡§∏‡•á ‡§ë‡§´‡§ø‡§∏\\n`;\n    cart.forEach(item => {\n      const totalQty = item.entries.reduce((sum, e) => sum + (e.qty || 0) * (e.ctn || 0), 0);\n      msg += `\\n\\nüîπ *${item.name}* Total = *${totalQty}* pcs`;\n      item.entries.forEach(e => {\n        msg += `\\n  Batch: ${e.batch || '-'}, *${e.qty || 0}* pc √ó ${e.ctn || 0} ‡§ï‡§æ‡§∞‡•ç‡§ü‡•Ç‡§®`;\n      });\n    });\n    msg += `\\n\\nüöõ Vehicle: ${vehicleName || 'N/A'} (${vehicleNumber || 'N/A'})`;\n    msg += `\\nüì¶ Total CTNs: ${totalCTN || 0}`;\n    if (notes) msg += `\\nüìù Notes: ${notes}`;\n    console.log(\"üì¶ WhatsApp Message Preview:\\n\", msg);\n\n    // ‚úÖ 3. Send WhatsApp\n    sendViaWhatsApp(phoneNumber, msg);\n    return true; // ‚úÖ Success\n  } catch (error) {\n    console.error(\"‚ùå submitOrder failed:\", error);\n    if (typeof showToast === 'function') {\n      showToast(\"‚ùå Failed to export or send order\");\n    }\n    return false; // ‚ùå Failure\n  }\n}","map":{"version":3,"names":["sendViaWhatsApp","exportToCSV","submitOrder","cart","dealer","vehicleName","vehicleNumber","notes","totalCTN","showToast","dealerName","phoneNumber","timestamp","Date","toLocaleString","replace","safeDealer","filename","msg","forEach","item","totalQty","entries","reduce","sum","e","qty","ctn","name","batch","console","log","error"],"sources":["C:/Users/Jai Ayurved research/Documents/Projects/Projuect Supervisor/src/utils/submitOrder.js"],"sourcesContent":["// submitOrder.js\r\nimport sendViaWhatsApp from './sendViaWhatsApp';\r\nimport exportToCSV from './exportToCSV'; // For stock journal Excel\r\n\r\nexport default function submitOrder({\r\n  cart,\r\n  dealer,\r\n  vehicleName,\r\n  vehicleNumber,\r\n  notes,\r\n  totalCTN,\r\n  showToast\r\n}) {\r\n  try {\r\n    const dealerName = dealer?.[\"Dealer Name\"] || \"Unknown Dealer\";\r\n    const phoneNumber = dealer?.[\"Phone Number\"] || \"919929988408\";\r\n\r\n    const timestamp = new Date().toLocaleString().replace(/[/,: ]+/g, \"_\");\r\n    const safeDealer = dealerName.replace(/\\s+/g, \"_\");\r\n    const filename = `${safeDealer}_${timestamp}`;\r\n\r\n    // ‚úÖ 1. Export Excel\r\n    exportToCSV(cart, filename, vehicleName, vehicleNumber, notes);\r\n    if (typeof showToast === 'function') {\r\n      showToast(\"üßæ Stock Journal Excel downloaded\");\r\n    }\r\n\r\n    // ‚úÖ 2. Build WhatsApp message\r\n    let msg = `üõí *Factory to Office Dispatch Summary*\\nüë§ ‡§∏‡§∞‡§®‡§æ ‡§∏‡•á ‡§ë‡§´‡§ø‡§∏\\n`;\r\n\r\n    cart.forEach(item => {\r\n      const totalQty = item.entries.reduce(\r\n        (sum, e) => sum + ((e.qty || 0) * (e.ctn || 0)),\r\n        0\r\n      );\r\n\r\n      msg += `\\n\\nüîπ *${item.name}* Total = *${totalQty}* pcs`;\r\n      item.entries.forEach(e => {\r\n        msg += `\\n  Batch: ${e.batch || '-'}, *${e.qty || 0}* pc √ó ${e.ctn || 0} ‡§ï‡§æ‡§∞‡•ç‡§ü‡•Ç‡§®`;\r\n      });\r\n    });\r\n\r\n    msg += `\\n\\nüöõ Vehicle: ${vehicleName || 'N/A'} (${vehicleNumber || 'N/A'})`;\r\n    msg += `\\nüì¶ Total CTNs: ${totalCTN || 0}`;\r\n    if (notes) msg += `\\nüìù Notes: ${notes}`;\r\n\r\n    console.log(\"üì¶ WhatsApp Message Preview:\\n\", msg);\r\n\r\n    // ‚úÖ 3. Send WhatsApp\r\n    sendViaWhatsApp(phoneNumber, msg);\r\n\r\n    return true; // ‚úÖ Success\r\n  } catch (error) {\r\n    console.error(\"‚ùå submitOrder failed:\", error);\r\n    if (typeof showToast === 'function') {\r\n      showToast(\"‚ùå Failed to export or send order\");\r\n    }\r\n    return false; // ‚ùå Failure\r\n  }\r\n}\r\n"],"mappings":"AAAA;AACA,OAAOA,eAAe,MAAM,mBAAmB;AAC/C,OAAOC,WAAW,MAAM,eAAe,CAAC,CAAC;;AAEzC,eAAe,SAASC,WAAWA,CAAC;EAClCC,IAAI;EACJC,MAAM;EACNC,WAAW;EACXC,aAAa;EACbC,KAAK;EACLC,QAAQ;EACRC;AACF,CAAC,EAAE;EACD,IAAI;IACF,MAAMC,UAAU,GAAG,CAAAN,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAG,aAAa,CAAC,KAAI,gBAAgB;IAC9D,MAAMO,WAAW,GAAG,CAAAP,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAG,cAAc,CAAC,KAAI,cAAc;IAE9D,MAAMQ,SAAS,GAAG,IAAIC,IAAI,CAAC,CAAC,CAACC,cAAc,CAAC,CAAC,CAACC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC;IACtE,MAAMC,UAAU,GAAGN,UAAU,CAACK,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC;IAClD,MAAME,QAAQ,GAAG,GAAGD,UAAU,IAAIJ,SAAS,EAAE;;IAE7C;IACAX,WAAW,CAACE,IAAI,EAAEc,QAAQ,EAAEZ,WAAW,EAAEC,aAAa,EAAEC,KAAK,CAAC;IAC9D,IAAI,OAAOE,SAAS,KAAK,UAAU,EAAE;MACnCA,SAAS,CAAC,mCAAmC,CAAC;IAChD;;IAEA;IACA,IAAIS,GAAG,GAAG,4DAA4D;IAEtEf,IAAI,CAACgB,OAAO,CAACC,IAAI,IAAI;MACnB,MAAMC,QAAQ,GAAGD,IAAI,CAACE,OAAO,CAACC,MAAM,CAClC,CAACC,GAAG,EAAEC,CAAC,KAAKD,GAAG,GAAI,CAACC,CAAC,CAACC,GAAG,IAAI,CAAC,KAAKD,CAAC,CAACE,GAAG,IAAI,CAAC,CAAE,EAC/C,CACF,CAAC;MAEDT,GAAG,IAAI,WAAWE,IAAI,CAACQ,IAAI,cAAcP,QAAQ,OAAO;MACxDD,IAAI,CAACE,OAAO,CAACH,OAAO,CAACM,CAAC,IAAI;QACxBP,GAAG,IAAI,cAAcO,CAAC,CAACI,KAAK,IAAI,GAAG,MAAMJ,CAAC,CAACC,GAAG,IAAI,CAAC,UAAUD,CAAC,CAACE,GAAG,IAAI,CAAC,UAAU;MACnF,CAAC,CAAC;IACJ,CAAC,CAAC;IAEFT,GAAG,IAAI,mBAAmBb,WAAW,IAAI,KAAK,KAAKC,aAAa,IAAI,KAAK,GAAG;IAC5EY,GAAG,IAAI,oBAAoBV,QAAQ,IAAI,CAAC,EAAE;IAC1C,IAAID,KAAK,EAAEW,GAAG,IAAI,eAAeX,KAAK,EAAE;IAExCuB,OAAO,CAACC,GAAG,CAAC,gCAAgC,EAAEb,GAAG,CAAC;;IAElD;IACAlB,eAAe,CAACW,WAAW,EAAEO,GAAG,CAAC;IAEjC,OAAO,IAAI,CAAC,CAAC;EACf,CAAC,CAAC,OAAOc,KAAK,EAAE;IACdF,OAAO,CAACE,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;IAC7C,IAAI,OAAOvB,SAAS,KAAK,UAAU,EAAE;MACnCA,SAAS,CAAC,kCAAkC,CAAC;IAC/C;IACA,OAAO,KAAK,CAAC,CAAC;EAChB;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}