{"ast":null,"code":"// utils/submitOrder.js\nimport sendViaWhatsApp from './sendViaWhatsApp';\nimport exportToCSV from './exportToCSV'; // ‚úÖ Needed for Stock Journal Excel\n\nexport default function submitOrder({\n  cart,\n  dealer,\n  vehicleName,\n  vehicleNumber,\n  notes,\n  totalCTN,\n  showToast\n}) {\n  const dealerName = (dealer === null || dealer === void 0 ? void 0 : dealer[\"Dealer Name\"]) || \"Unknown Dealer\";\n  const timestamp = new Date().toLocaleString().replace(/[/,: ]+/g, \"_\");\n  const safeDealer = dealerName.replace(/\\s+/g, \"_\");\n  const filename = `${safeDealer}_${timestamp}`;\n\n  // ‚úÖ 1. Export StockJournal Excel first\n  exportToCSV(cart, filename, vehicleName, vehicleNumber, notes);\n  if (typeof showToast === 'function') {\n    showToast(\"üßæ Stock Journal Excel downloaded\");\n  }\n\n  // ‚úÖ 2. Build WhatsApp Message\n  let msg = `üõí *Factory to office Dispatch Summary* \\n`;\n  msg += `üë§ ‡§∏‡§∞‡§®‡§æ ‡§∏‡•á ‡§ë‡§´‡§ø‡§∏\\n`;\n  cart.forEach(item => {\n    const totalItemQty = item.entries.reduce((sum, e) => sum + (e.qty || 0) * (e.ctn || 0), 0);\n    msg += `\\n\\n\\n üîπ *${item.name}* Total= *${totalItemQty}* pcs`;\n    item.entries.forEach(entry => {\n      msg += `\\n  Batch: ${entry.batch || '-'}, *${entry.qty || 0}* pc X ${entry.ctn || 0} ‡§ï‡§æ‡§∞‡•ç‡§ü‡•Ç‡§®`;\n    });\n  });\n  msg += `\\n\\n\\n\\n\\n\\nüöõ Vehicle: ${vehicleName || 'N/A'} (${vehicleNumber || 'N/A'})`;\n  msg += `\\nüì¶ Total CTNs: ${totalCTN || 0}`;\n  if (notes) msg += `\\nüìù Notes: ${notes}`;\n  console.log(\"üì¶ WhatsApp Message Preview:\\n\", msg);\n\n  // ‚úÖ 3. Send WhatsApp\n  sendViaWhatsApp((dealer === null || dealer === void 0 ? void 0 : dealer[\"Phone Number\"]) || \"919929988408\", msg);\n}","map":{"version":3,"names":["sendViaWhatsApp","exportToCSV","submitOrder","cart","dealer","vehicleName","vehicleNumber","notes","totalCTN","showToast","dealerName","timestamp","Date","toLocaleString","replace","safeDealer","filename","msg","forEach","item","totalItemQty","entries","reduce","sum","e","qty","ctn","name","entry","batch","console","log"],"sources":["C:/Users/Jai Ayurved research/Documents/Projects/Projuect Supervisor/src/utils/submitOrder.js"],"sourcesContent":["// utils/submitOrder.js\r\nimport sendViaWhatsApp from './sendViaWhatsApp';\r\nimport exportToCSV from './exportToCSV'; // ‚úÖ Needed for Stock Journal Excel\r\n\r\nexport default function submitOrder({ cart, dealer, vehicleName, vehicleNumber, notes, totalCTN, showToast }) {\r\n  const dealerName = dealer?.[\"Dealer Name\"] || \"Unknown Dealer\";\r\n\r\n  const timestamp = new Date().toLocaleString().replace(/[/,: ]+/g, \"_\");\r\n  const safeDealer = dealerName.replace(/\\s+/g, \"_\");\r\n  const filename = `${safeDealer}_${timestamp}`;\r\n\r\n  // ‚úÖ 1. Export StockJournal Excel first\r\n  exportToCSV(cart, filename, vehicleName, vehicleNumber, notes);\r\n\r\n  if (typeof showToast === 'function') {\r\n    showToast(\"üßæ Stock Journal Excel downloaded\");\r\n  }\r\n\r\n  // ‚úÖ 2. Build WhatsApp Message\r\n  let msg = `üõí *Factory to office Dispatch Summary* \\n`;\r\n  msg += `üë§ ‡§∏‡§∞‡§®‡§æ ‡§∏‡•á ‡§ë‡§´‡§ø‡§∏\\n`;\r\n\r\n  cart.forEach(item => {\r\n    const totalItemQty = item.entries.reduce(\r\n      (sum, e) => sum + ((e.qty || 0) * (e.ctn || 0)),\r\n      0\r\n    );\r\n\r\n    msg += `\\n\\n\\n üîπ *${item.name}* Total= *${totalItemQty}* pcs`;\r\n\r\n    item.entries.forEach(entry => {\r\n      msg += `\\n  Batch: ${entry.batch || '-'}, *${entry.qty || 0}* pc X ${entry.ctn || 0} ‡§ï‡§æ‡§∞‡•ç‡§ü‡•Ç‡§®`;\r\n    });\r\n  });\r\n\r\n  msg += `\\n\\n\\n\\n\\n\\nüöõ Vehicle: ${vehicleName || 'N/A'} (${vehicleNumber || 'N/A'})`;\r\n  msg += `\\nüì¶ Total CTNs: ${totalCTN || 0}`;\r\n  if (notes) msg += `\\nüìù Notes: ${notes}`;\r\n\r\n  console.log(\"üì¶ WhatsApp Message Preview:\\n\", msg);\r\n\r\n  // ‚úÖ 3. Send WhatsApp\r\n  sendViaWhatsApp(dealer?.[\"Phone Number\"] || \"919929988408\", msg);\r\n\r\n}\r\n"],"mappings":"AAAA;AACA,OAAOA,eAAe,MAAM,mBAAmB;AAC/C,OAAOC,WAAW,MAAM,eAAe,CAAC,CAAC;;AAEzC,eAAe,SAASC,WAAWA,CAAC;EAAEC,IAAI;EAAEC,MAAM;EAAEC,WAAW;EAAEC,aAAa;EAAEC,KAAK;EAAEC,QAAQ;EAAEC;AAAU,CAAC,EAAE;EAC5G,MAAMC,UAAU,GAAG,CAAAN,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAG,aAAa,CAAC,KAAI,gBAAgB;EAE9D,MAAMO,SAAS,GAAG,IAAIC,IAAI,CAAC,CAAC,CAACC,cAAc,CAAC,CAAC,CAACC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC;EACtE,MAAMC,UAAU,GAAGL,UAAU,CAACI,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC;EAClD,MAAME,QAAQ,GAAG,GAAGD,UAAU,IAAIJ,SAAS,EAAE;;EAE7C;EACAV,WAAW,CAACE,IAAI,EAAEa,QAAQ,EAAEX,WAAW,EAAEC,aAAa,EAAEC,KAAK,CAAC;EAE9D,IAAI,OAAOE,SAAS,KAAK,UAAU,EAAE;IACnCA,SAAS,CAAC,mCAAmC,CAAC;EAChD;;EAEA;EACA,IAAIQ,GAAG,GAAG,4CAA4C;EACtDA,GAAG,IAAI,mBAAmB;EAE1Bd,IAAI,CAACe,OAAO,CAACC,IAAI,IAAI;IACnB,MAAMC,YAAY,GAAGD,IAAI,CAACE,OAAO,CAACC,MAAM,CACtC,CAACC,GAAG,EAAEC,CAAC,KAAKD,GAAG,GAAI,CAACC,CAAC,CAACC,GAAG,IAAI,CAAC,KAAKD,CAAC,CAACE,GAAG,IAAI,CAAC,CAAE,EAC/C,CACF,CAAC;IAEDT,GAAG,IAAI,cAAcE,IAAI,CAACQ,IAAI,aAAaP,YAAY,OAAO;IAE9DD,IAAI,CAACE,OAAO,CAACH,OAAO,CAACU,KAAK,IAAI;MAC5BX,GAAG,IAAI,cAAcW,KAAK,CAACC,KAAK,IAAI,GAAG,MAAMD,KAAK,CAACH,GAAG,IAAI,CAAC,UAAUG,KAAK,CAACF,GAAG,IAAI,CAAC,UAAU;IAC/F,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFT,GAAG,IAAI,2BAA2BZ,WAAW,IAAI,KAAK,KAAKC,aAAa,IAAI,KAAK,GAAG;EACpFW,GAAG,IAAI,oBAAoBT,QAAQ,IAAI,CAAC,EAAE;EAC1C,IAAID,KAAK,EAAEU,GAAG,IAAI,eAAeV,KAAK,EAAE;EAExCuB,OAAO,CAACC,GAAG,CAAC,gCAAgC,EAAEd,GAAG,CAAC;;EAElD;EACAjB,eAAe,CAAC,CAAAI,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAG,cAAc,CAAC,KAAI,cAAc,EAAEa,GAAG,CAAC;AAElE","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}