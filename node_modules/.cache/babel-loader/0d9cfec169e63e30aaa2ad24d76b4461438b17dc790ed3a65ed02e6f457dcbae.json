{"ast":null,"code":"// utils/submitOrder.js (final with timestamp + toast support)\nimport exportToCSV from'./exportToCSV';import sendViaWhatsApp from'./sendViaWhatsApp';export default function submitOrder(_ref){let{cart,dealer,vehicleName,vehicleNumber,notes,totalCTN,showToast}=_ref;const dealerName=(dealer===null||dealer===void 0?void 0:dealer[\"Dealer Name\"])||\"Unknown Dealer\";// ‚úÖ 1. Create safe, timestamped filename\nconst timestamp=new Date().toLocaleString().replace(/[/,: ]+/g,\"_\");const safeDealer=dealerName.replace(/\\s+/g,\"_\");const filename=`${safeDealer}_${timestamp}`;// ‚úÖ 2. Export to CSV with custom filename\nexportToCSV(cart,filename,vehicleName,vehicleNumber,notes);if(typeof showToast==='function'){showToast(\"üßæ CSV auto-downloaded\");}// ‚úÖ 3. Build WhatsApp message\nlet msg=`üõí *Factory Dispatch Summary*\\n\\n`;msg+=`üë§ Dealer: ${dealerName}\\n`;cart.forEach(item=>{const totalItemQty=item.entries.reduce((sum,e)=>sum+(e.qty||0)*(e.ctn||0),0);msg+=`\\nüîπ ${item.name} ‚Äì ${totalItemQty} pcs`;item.entries.forEach(entry=>{msg+=`\\n\\n\\n  üì¶ Batch: ${entry.batch||'-'}, Qty: ${entry.qty||0}, CTN: ${entry.ctn||0}`;});});msg+=`\\n\\nüöõ Vehicle: ${vehicleName||'N/A'} (${vehicleNumber||'N/A'})`;msg+=`\\nüì¶ Total CTNs: ${totalCTN||0}`;if(notes)msg+=`\\nüìù Notes: ${notes}`;msg+=`\\n\\n‚úÖ CSV attached. Please review.`;console.log(\"üì¶ WhatsApp Message Preview:\\n\",msg);// ‚úÖ 4. Open WhatsApp\nsendViaWhatsApp(\"919829280873\",msg);}","map":{"version":3,"names":["exportToCSV","sendViaWhatsApp","submitOrder","_ref","cart","dealer","vehicleName","vehicleNumber","notes","totalCTN","showToast","dealerName","timestamp","Date","toLocaleString","replace","safeDealer","filename","msg","forEach","item","totalItemQty","entries","reduce","sum","e","qty","ctn","name","entry","batch","console","log"],"sources":["C:/Users/Jai Ayurved research/Documents/Projuect Supervisor/src/utils/submitOrder.js"],"sourcesContent":["// utils/submitOrder.js (final with timestamp + toast support)\r\nimport exportToCSV from './exportToCSV';\r\nimport sendViaWhatsApp from './sendViaWhatsApp';\r\n\r\nexport default function submitOrder({ cart, dealer, vehicleName, vehicleNumber, notes, totalCTN, showToast }) {\r\n  const dealerName = dealer?.[\"Dealer Name\"] || \"Unknown Dealer\";\r\n\r\n  // ‚úÖ 1. Create safe, timestamped filename\r\n  const timestamp = new Date().toLocaleString().replace(/[/,: ]+/g, \"_\");\r\n  const safeDealer = dealerName.replace(/\\s+/g, \"_\");\r\n  const filename = `${safeDealer}_${timestamp}`;\r\n\r\n  // ‚úÖ 2. Export to CSV with custom filename\r\n  exportToCSV(cart, filename, vehicleName, vehicleNumber, notes);\r\n\r\n  if (typeof showToast === 'function') {\r\n    showToast(\"üßæ CSV auto-downloaded\");\r\n  }\r\n\r\n  // ‚úÖ 3. Build WhatsApp message\r\n  let msg = `üõí *Factory Dispatch Summary*\\n\\n`;\r\n  msg += `üë§ Dealer: ${dealerName}\\n`;\r\n\r\n  cart.forEach(item => {\r\n    const totalItemQty = item.entries.reduce(\r\n      (sum, e) => sum + ((e.qty || 0) * (e.ctn || 0)),\r\n      0\r\n    );\r\n\r\n    msg += `\\nüîπ ${item.name} ‚Äì ${totalItemQty} pcs`;\r\n\r\n    item.entries.forEach(entry => {\r\n      msg += `\\n\\n\\n  üì¶ Batch: ${entry.batch || '-'}, Qty: ${entry.qty || 0}, CTN: ${entry.ctn || 0}`;\r\n    });\r\n  });\r\n\r\n  msg += `\\n\\nüöõ Vehicle: ${vehicleName || 'N/A'} (${vehicleNumber || 'N/A'})`;\r\n  msg += `\\nüì¶ Total CTNs: ${totalCTN || 0}`;\r\n  if (notes) msg += `\\nüìù Notes: ${notes}`;\r\n  msg += `\\n\\n‚úÖ CSV attached. Please review.`;\r\n\r\n  console.log(\"üì¶ WhatsApp Message Preview:\\n\", msg);\r\n\r\n  // ‚úÖ 4. Open WhatsApp\r\n  sendViaWhatsApp(\"919829280873\", msg);\r\n}\r\n"],"mappings":"AAAA;AACA,MAAO,CAAAA,WAAW,KAAM,eAAe,CACvC,MAAO,CAAAC,eAAe,KAAM,mBAAmB,CAE/C,cAAe,SAAS,CAAAC,WAAWA,CAAAC,IAAA,CAA2E,IAA1E,CAAEC,IAAI,CAAEC,MAAM,CAAEC,WAAW,CAAEC,aAAa,CAAEC,KAAK,CAAEC,QAAQ,CAAEC,SAAU,CAAC,CAAAP,IAAA,CAC1G,KAAM,CAAAQ,UAAU,CAAG,CAAAN,MAAM,SAANA,MAAM,iBAANA,MAAM,CAAG,aAAa,CAAC,GAAI,gBAAgB,CAE9D;AACA,KAAM,CAAAO,SAAS,CAAG,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,cAAc,CAAC,CAAC,CAACC,OAAO,CAAC,UAAU,CAAE,GAAG,CAAC,CACtE,KAAM,CAAAC,UAAU,CAAGL,UAAU,CAACI,OAAO,CAAC,MAAM,CAAE,GAAG,CAAC,CAClD,KAAM,CAAAE,QAAQ,CAAG,GAAGD,UAAU,IAAIJ,SAAS,EAAE,CAE7C;AACAZ,WAAW,CAACI,IAAI,CAAEa,QAAQ,CAAEX,WAAW,CAAEC,aAAa,CAAEC,KAAK,CAAC,CAE9D,GAAI,MAAO,CAAAE,SAAS,GAAK,UAAU,CAAE,CACnCA,SAAS,CAAC,wBAAwB,CAAC,CACrC,CAEA;AACA,GAAI,CAAAQ,GAAG,CAAG,mCAAmC,CAC7CA,GAAG,EAAI,cAAcP,UAAU,IAAI,CAEnCP,IAAI,CAACe,OAAO,CAACC,IAAI,EAAI,CACnB,KAAM,CAAAC,YAAY,CAAGD,IAAI,CAACE,OAAO,CAACC,MAAM,CACtC,CAACC,GAAG,CAAEC,CAAC,GAAKD,GAAG,CAAI,CAACC,CAAC,CAACC,GAAG,EAAI,CAAC,GAAKD,CAAC,CAACE,GAAG,EAAI,CAAC,CAAE,CAC/C,CACF,CAAC,CAEDT,GAAG,EAAI,QAAQE,IAAI,CAACQ,IAAI,MAAMP,YAAY,MAAM,CAEhDD,IAAI,CAACE,OAAO,CAACH,OAAO,CAACU,KAAK,EAAI,CAC5BX,GAAG,EAAI,qBAAqBW,KAAK,CAACC,KAAK,EAAI,GAAG,UAAUD,KAAK,CAACH,GAAG,EAAI,CAAC,UAAUG,KAAK,CAACF,GAAG,EAAI,CAAC,EAAE,CAClG,CAAC,CAAC,CACJ,CAAC,CAAC,CAEFT,GAAG,EAAI,mBAAmBZ,WAAW,EAAI,KAAK,KAAKC,aAAa,EAAI,KAAK,GAAG,CAC5EW,GAAG,EAAI,oBAAoBT,QAAQ,EAAI,CAAC,EAAE,CAC1C,GAAID,KAAK,CAAEU,GAAG,EAAI,eAAeV,KAAK,EAAE,CACxCU,GAAG,EAAI,oCAAoC,CAE3Ca,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAEd,GAAG,CAAC,CAElD;AACAjB,eAAe,CAAC,cAAc,CAAEiB,GAAG,CAAC,CACtC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}