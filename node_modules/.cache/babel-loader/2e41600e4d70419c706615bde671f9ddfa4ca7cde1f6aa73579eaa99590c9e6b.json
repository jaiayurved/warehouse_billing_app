{"ast":null,"code":"import{useState,useEffect}from'react';const STORAGE_KEYS={CART:\"cart_v3\"};export default function useCart(showToast){const[cart,setCart]=useState([]);const[vehicleName,setVehicleName]=useState(\"\");const[vehicleNumber,setVehicleNumber]=useState(\"\");const[notes,setNotes]=useState(\"\");useEffect(()=>{const stored=JSON.parse(localStorage.getItem(STORAGE_KEYS.CART)||\"[]\");setCart(stored);},[]);useEffect(()=>{localStorage.setItem(STORAGE_KEYS.CART,JSON.stringify(cart));},[cart]);const handleAdd=item=>{const existing=cart.find(c=>c.name===item.name);if(!existing){const newItem={name:item.name,entries:[{batch:\"\",mfg:\"\",exp:\"\",qty:0,ctn:0}]};setCart(prev=>[...prev,newItem]);}else{showToast(\"âš ï¸ Item already added â€” use +Batch to add more\");}};const handleRemove=function(itemIndex){let batchIndex=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;const newCart=[...cart];if(batchIndex===null){newCart.splice(itemIndex,1);}else{newCart[itemIndex].entries.splice(batchIndex,1);if(newCart[itemIndex].entries.length===0){newCart.splice(itemIndex,1);}}setCart(newCart);showToast(\"âŒ Removed\");};const handleBatchChange=(itemIndex,batchIndex,field,value)=>{const newCart=[...cart];newCart[itemIndex].entries[batchIndex][field]=[\"qty\",\"ctn\"].includes(field)?parseInt(value)||0:value;setCart(newCart);};const handleAddBatch=itemIndex=>{const newCart=[...cart];newCart[itemIndex].entries.push({batch:\"\",mfg:\"\",exp:\"\",qty:0,ctn:0});setCart(newCart);};const handleSubmit=()=>{const valid=cart.every(item=>item.entries.every(e=>e.batch&&(e.qty>0||e.ctn>0)));if(!valid){showToast(\"âš ï¸ Please fill batch, qty or CTN for all entries\");return;}console.log(\"ðŸ›’ Final Order:\",cart);console.log(\"ðŸšš Vehicle Name:\",vehicleName);console.log(\"ðŸ”¢ Vehicle Number:\",vehicleNumber);console.log(\"ðŸ“ Notes:\",notes);showToast(\"âœ… Order submitted (local only)\");};const resetCart=()=>{localStorage.removeItem(STORAGE_KEYS.CART);setCart([]);setVehicleName(\"\");setVehicleNumber(\"\");setNotes(\"\");};const totalCTN=cart.reduce((sum,item)=>sum+item.entries.reduce((eSum,e)=>eSum+(e.ctn||0),0),0);return{cart,handleAdd,handleRemove,handleBatchChange,handleAddBatch,handleSubmit,resetCart,totalCTN,vehicleName,setVehicleName,vehicleNumber,setVehicleNumber,notes,setNotes};}","map":{"version":3,"names":["useState","useEffect","STORAGE_KEYS","CART","useCart","showToast","cart","setCart","vehicleName","setVehicleName","vehicleNumber","setVehicleNumber","notes","setNotes","stored","JSON","parse","localStorage","getItem","setItem","stringify","handleAdd","item","existing","find","c","name","newItem","entries","batch","mfg","exp","qty","ctn","prev","handleRemove","itemIndex","batchIndex","arguments","length","undefined","newCart","splice","handleBatchChange","field","value","includes","parseInt","handleAddBatch","push","handleSubmit","valid","every","e","console","log","resetCart","removeItem","totalCTN","reduce","sum","eSum"],"sources":["C:/Users/Jai Ayurved research/Documents/Projuect Supervisor/src/hooks/useCartLogic.js"],"sourcesContent":["import { useState, useEffect } from 'react';\n\nconst STORAGE_KEYS = {\n  CART: \"cart_v3\"\n};\n\nexport default function useCart(showToast) {\n  const [cart, setCart] = useState([]);\n  const [vehicleName, setVehicleName] = useState(\"\");\n  const [vehicleNumber, setVehicleNumber] = useState(\"\");\n  const [notes, setNotes] = useState(\"\");\n\n  useEffect(() => {\n    const stored = JSON.parse(localStorage.getItem(STORAGE_KEYS.CART) || \"[]\");\n    setCart(stored);\n  }, []);\n\n  useEffect(() => {\n    localStorage.setItem(STORAGE_KEYS.CART, JSON.stringify(cart));\n  }, [cart]);\n\n  const handleAdd = (item) => {\n    const existing = cart.find(c => c.name === item.name);\n    if (!existing) {\n      const newItem = {\n        name: item.name,\n        entries: [{ batch: \"\", mfg: \"\", exp: \"\", qty: 0, ctn: 0 }]\n      };\n      setCart(prev => [...prev, newItem]);\n    } else {\n      showToast(\"âš ï¸ Item already added â€” use +Batch to add more\");\n    }\n  };\n\n  const handleRemove = (itemIndex, batchIndex = null) => {\n    const newCart = [...cart];\n    if (batchIndex === null) {\n      newCart.splice(itemIndex, 1);\n    } else {\n      newCart[itemIndex].entries.splice(batchIndex, 1);\n      if (newCart[itemIndex].entries.length === 0) {\n        newCart.splice(itemIndex, 1);\n      }\n    }\n    setCart(newCart);\n    showToast(\"âŒ Removed\");\n  };\n\n  const handleBatchChange = (itemIndex, batchIndex, field, value) => {\n    const newCart = [...cart];\n    newCart[itemIndex].entries[batchIndex][field] =\n      [\"qty\", \"ctn\"].includes(field) ? parseInt(value) || 0 : value;\n    setCart(newCart);\n  };\n\n  const handleAddBatch = (itemIndex) => {\n    const newCart = [...cart];\n    newCart[itemIndex].entries.push({ batch: \"\", mfg: \"\", exp: \"\", qty: 0, ctn: 0 });\n    setCart(newCart);\n  };\n\n  const handleSubmit = () => {\n    const valid = cart.every(item =>\n      item.entries.every(e => e.batch && (e.qty > 0 || e.ctn > 0))\n    );\n    if (!valid) {\n      showToast(\"âš ï¸ Please fill batch, qty or CTN for all entries\");\n      return;\n    }\n    console.log(\"ðŸ›’ Final Order:\", cart);\n    console.log(\"ðŸšš Vehicle Name:\", vehicleName);\n    console.log(\"ðŸ”¢ Vehicle Number:\", vehicleNumber);\n    console.log(\"ðŸ“ Notes:\", notes);\n    showToast(\"âœ… Order submitted (local only)\");\n  };\n\n  const resetCart = () => {\n    localStorage.removeItem(STORAGE_KEYS.CART);\n    setCart([]);\n    setVehicleName(\"\");\n    setVehicleNumber(\"\");\n    setNotes(\"\");\n  };\n\n  const totalCTN = cart.reduce(\n    (sum, item) =>\n      sum + item.entries.reduce((eSum, e) => eSum + (e.ctn || 0), 0),\n    0\n  );\n\n  return {\n    cart,\n    handleAdd,\n    handleRemove,\n    handleBatchChange,\n    handleAddBatch,\n    handleSubmit,\n    resetCart,\n    totalCTN,\n    vehicleName,\n    setVehicleName,\n    vehicleNumber,\n    setVehicleNumber,\n    notes,\n    setNotes\n  };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}